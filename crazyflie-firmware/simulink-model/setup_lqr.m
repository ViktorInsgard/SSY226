
F = 0;
m = 0.027;
d = 0.046;
Jx = 1.395e-5;
Jy = 1.436e-5;
Jz = 2.173e-5;
b = 2.75e-11;
k = 1e-9;
g = 9.82;
A = [0 0 0 1 0 0 0  0 0 0 0 0;
     0 0 0 0 1 0 0  0 0 -3 0 0;
     0 0 0 0 0 1 0  0 0 0 0 0;
     0 0 0 0 0 0 g  0 0 0 0 0;
     0 0 0 0 0 0 -g 0 0 0 0 0;
     0 0 0 0 0 0 0  0 0 0 0 0;
     0 0 0 0 0 0 0  0 0 1 0 0;
     0 0 0 0 0 0 0  0 0 0 1 0;
     0 0 0 0 0 0 0  0 0 0 0 1;
     0 0 0 0 0 0 0  0 0 0 0 0;
     0 0 0 0 0 0 0  0 0 0 0 0;
     0 0 0 0 0 0 0  0 0 0 0 0];

Ar = [0 0 0 1 0 0;
      0 0 0 0 1 0;
      0 0 0 0 0 1;
      0 0 0 0 0 0;
      0 0 0 0 0 0;
      0 0 0 0 0 0];
 
B = [0 0 0 0;
     0 0 0 0;
     0 0 0 0;
     0 0 0 0;
     0 0 0 0;
     g g g g;
     0 0 0 0;
     0 0 0 0;
     0 0 0 0;
     -d/(Jx*sqrt(2)) -d/(Jx*sqrt(2)) d/(Jx*sqrt(2)) d/(Jx*sqrt(2));
     -d/(Jy*sqrt(2)) d/(Jy*sqrt(2)) d/(Jy*sqrt(2)) -d/(Jy*sqrt(2));
     -b/(k*Jz) b/(k*Jz) -b/(k*Jz) b/(k*Jz)];
 
Br = [0 0 0 0;
      0 0 0 0;
      0 0 0 0;
     -d/(Jx*sqrt(2)) -d/(Jx*sqrt(2)) d/(Jx*sqrt(2)) d/(Jx*sqrt(2));
     -d/(Jy*sqrt(2)) d/(Jy*sqrt(2)) d/(Jy*sqrt(2)) -d/(Jy*sqrt(2));
     -b/(k*Jz) b/(k*Jz) -b/(k*Jz) b/(k*Jz)];

C = [ 0 0 0 0 0 0 1 0 0 0 0 0;
      0 0 0 0 0 0 0 1 0 0 0 0;
      0 0 0 0 0 0 0 0 1 0 0 0;
      0 0 0 0 0 0 0 0 0 1 0 0;
      0 0 0 0 0 0 0 0 0 0 1 0;
      0 0 0 0 0 0 0 0 0 0 0 1];
        
  
Ts = 0.001;
Q_lqr = diag([1 1 0.3 0.001 0.001 0.001]);
R_lqr = 50000*eye(4)
[Kd, S, e] = lqrd(Ar, Br, Q_lqr, R_lqr, Ts);

%Q_kal = 1*eye(4);
%R_kal = 1*eye(6);
%plant = ss(A, B, C, zeros(6, 4));
%[kest, L, P, M, Z] = kalmd(plant, Q_kal, R_kal, Ts);